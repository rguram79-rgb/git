<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0d1117">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="manifest" href="manifest.json">
    <title>GitMaster</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Courier New', monospace;
            background: #0d1117;
            color: #c9d1d9;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Matrix Rain Background */
        #matrix-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            opacity: 0.1;
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, rgba(246,106,10,0.2), rgba(255,123,0,0.1));
            border: 1px solid #f6690a;
            border-radius: 20px;
            margin-bottom: 20px;
        }

        .logo {
            font-size: 3em;
            font-weight: 800;
            background: linear-gradient(90deg, #f6690a, #ff9500, #f6690a);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: glow 2s ease-in-out infinite;
        }

        @keyframes glow {
            0%, 100% { filter: drop-shadow(0 0 10px rgba(246,105,10,0.5)); }
            50% { filter: drop-shadow(0 0 20px rgba(246,105,10,0.8)); }
        }

        .subtitle {
            color: #8b949e;
            margin-top: 10px;
        }

        /* Stats Bar */
        .stats-bar {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #f6690a;
        }

        .stat-label {
            font-size: 0.75em;
            color: #8b949e;
            text-transform: uppercase;
            margin-top: 5px;
        }

        /* Main Layout */
        .main-layout {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 20px;
        }

        @media (max-width: 900px) {
            .main-layout { grid-template-columns: 1fr; }
            .stats-bar { grid-template-columns: repeat(2, 1fr); }
        }

        /* Terminal */
        .terminal {
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 15px;
            overflow: hidden;
        }

        .terminal-header {
            background: #21262d;
            padding: 12px 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .terminal-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .dot-red { background: #ff5f56; }
        .dot-yellow { background: #ffbd2e; }
        .dot-green { background: #27c93f; }

        .terminal-title {
            flex: 1;
            text-align: center;
            color: #8b949e;
            font-size: 0.9em;
        }

        .terminal-body {
            padding: 20px;
            height: 400px;
            overflow-y: auto;
            font-size: 14px;
            line-height: 1.6;
        }

        .terminal-body::-webkit-scrollbar {
            width: 8px;
        }

        .terminal-body::-webkit-scrollbar-thumb {
            background: #30363d;
            border-radius: 4px;
        }

        .output-line {
            margin-bottom: 5px;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .output-success { color: #3fb950; }
        .output-error { color: #f85149; }
        .output-info { color: #58a6ff; }
        .output-warning { color: #d29922; }
        .output-system { color: #8b949e; }
        .output-commit { color: #a371f7; }

        .prompt {
            color: #3fb950;
        }

        .prompt-path {
            color: #58a6ff;
        }

        .input-line {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }

        #commandInput {
            flex: 1;
            background: transparent;
            border: none;
            color: #c9d1d9;
            font-family: inherit;
            font-size: 14px;
            outline: none;
            caret-color: #f6690a;
        }

        .cursor {
            display: inline-block;
            width: 8px;
            height: 16px;
            background: #f6690a;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        /* Right Panel */
        .right-panel {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* Mission Card */
        .mission-card {
            background: linear-gradient(135deg, rgba(56,139,253,0.1), rgba(136,46,224,0.1));
            border: 1px solid #388bfd;
            border-radius: 15px;
            padding: 20px;
        }

        .mission-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .mission-level {
            background: #388bfd;
            color: #fff;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .mission-title {
            color: #58a6ff;
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .mission-desc {
            color: #8b949e;
            font-size: 0.9em;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .mission-goal {
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .mission-goal-title {
            color: #f6690a;
            font-size: 0.85em;
            margin-bottom: 8px;
        }

        .mission-goal-text {
            color: #3fb950;
            font-family: 'Courier New', monospace;
        }

        .hint-btn {
            width: 100%;
            padding: 12px;
            background: rgba(246,105,10,0.2);
            border: 1px solid #f6690a;
            border-radius: 10px;
            color: #f6690a;
            cursor: pointer;
            font-family: inherit;
            transition: all 0.3s;
        }

        .hint-btn:hover {
            background: rgba(246,105,10,0.3);
        }

        .hint-text {
            display: none;
            margin-top: 10px;
            padding: 15px;
            background: rgba(246,105,10,0.1);
            border-radius: 10px;
            color: #d29922;
            font-size: 0.9em;
        }

        .hint-text.visible { display: block; }

        /* Git Visualization */
        .git-viz {
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 15px;
            padding: 20px;
        }

        .git-viz-title {
            color: #8b949e;
            font-size: 0.9em;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .branch-container {
            position: relative;
            min-height: 150px;
        }

        .commit-node {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #238636;
            color: #fff;
            font-size: 0.8em;
            font-weight: bold;
            position: relative;
            margin: 5px;
            transition: all 0.3s;
        }

        .commit-node.active {
            box-shadow: 0 0 20px rgba(35,134,54,0.8);
            transform: scale(1.1);
        }

        .commit-node::after {
            content: '';
            position: absolute;
            right: -15px;
            width: 15px;
            height: 3px;
            background: #30363d;
        }

        .commit-node:last-child::after { display: none; }

        .branch-label {
            display: inline-block;
            padding: 3px 10px;
            background: #388bfd;
            color: #fff;
            border-radius: 5px;
            font-size: 0.75em;
            margin-left: 10px;
        }

        .branch-label.main { background: #238636; }
        .branch-label.feature { background: #a371f7; }

        .branch-row {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        /* Commands Reference */
        .commands-ref {
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 15px;
            padding: 20px;
            max-height: 250px;
            overflow-y: auto;
        }

        .commands-ref-title {
            color: #8b949e;
            font-size: 0.9em;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .cmd-item {
            padding: 10px;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .cmd-item:hover {
            background: rgba(246,105,10,0.2);
        }

        .cmd-name {
            color: #f6690a;
            font-size: 0.9em;
            margin-bottom: 3px;
        }

        .cmd-desc {
            color: #8b949e;
            font-size: 0.75em;
        }

        /* Achievements */
        .achievements {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .achievement {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #21262d;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            opacity: 0.3;
            transition: all 0.3s;
        }

        .achievement.unlocked {
            opacity: 1;
            box-shadow: 0 0 15px rgba(246,105,10,0.5);
        }

        /* Success Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 100;
            align-items: center;
            justify-content: center;
        }

        .modal.visible { display: flex; }

        .modal-content {
            background: #161b22;
            border: 2px solid #3fb950;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            max-width: 400px;
            animation: modalPop 0.5s ease;
        }

        @keyframes modalPop {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-emoji { font-size: 4em; margin-bottom: 20px; }
        .modal-title { color: #3fb950; font-size: 1.5em; margin-bottom: 10px; }
        .modal-text { color: #8b949e; margin-bottom: 20px; }
        .modal-xp { color: #f6690a; font-size: 1.2em; margin-bottom: 20px; }

        .modal-btn {
            padding: 15px 40px;
            background: linear-gradient(90deg, #3fb950, #238636);
            border: none;
            border-radius: 10px;
            color: #fff;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            font-family: inherit;
            transition: transform 0.3s;
        }

        .modal-btn:hover { transform: scale(1.05); }

        /* Level Select */
        .level-select {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 100;
            overflow-y: auto;
            padding: 40px 20px;
        }

        .level-select.visible { display: block; }

        .level-grid {
            max-width: 800px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .level-card {
            background: #161b22;
            border: 2px solid #30363d;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .level-card:hover {
            border-color: #f6690a;
            transform: translateY(-5px);
        }

        .level-card.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .level-card.completed {
            border-color: #3fb950;
        }

        .level-num {
            font-size: 2em;
            color: #f6690a;
            margin-bottom: 10px;
        }

        .level-name {
            color: #c9d1d9;
            margin-bottom: 5px;
        }

        .level-status {
            font-size: 0.8em;
            color: #8b949e;
        }

        .close-levels {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: #f85149;
            border: none;
            border-radius: 50%;
            color: #fff;
            font-size: 1.5em;
            cursor: pointer;
        }

        /* Typing effect */
        .typing {
            overflow: hidden;
            white-space: nowrap;
            animation: typing 0.5s steps(30);
        }

        @keyframes typing {
            from { width: 0; }
            to { width: 100%; }
        }
    </style>
</head>
<body>
    <canvas id="matrix-bg"></canvas>

    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo">‚ö° GitMaster</div>
            <p class="subtitle">–û—Å–≤–æ–π Git —á–µ—Ä–µ–∑ –ø—Ä–∞–∫—Ç–∏–∫—É</p>
            <div class="achievements" id="achievements"></div>
        </div>

        <!-- Stats -->
        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-value" id="levelNum">1</div>
                <div class="stat-label">–£—Ä–æ–≤–µ–Ω—å</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="xpNum">0</div>
                <div class="stat-label">XP</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="streakNum">0</div>
                <div class="stat-label">–°—Ç—Ä–∏–∫ üî•</div>
            </div>
            <div class="stat-item" style="cursor:pointer" onclick="showLevelSelect()">
                <div class="stat-value" id="completedNum">0/15</div>
                <div class="stat-label">–ú–∏—Å—Å–∏–∏ ‚ñ∂</div>
            </div>
        </div>

        <!-- Main Layout -->
        <div class="main-layout">
            <!-- Terminal -->
            <div class="terminal">
                <div class="terminal-header">
                    <div class="terminal-dot dot-red"></div>
                    <div class="terminal-dot dot-yellow"></div>
                    <div class="terminal-dot dot-green"></div>
                    <div class="terminal-title">git-bash ‚Äî ~/project</div>
                </div>
                <div class="terminal-body" id="terminalBody">
                    <div class="output-line output-system">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ GitMaster!</div>
                    <div class="output-line output-system">–í–≤–µ–¥–∏ –∫–æ–º–∞–Ω–¥—ã Git –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∏—Å—Å–∏–π.</div>
                    <div class="output-line output-system">–ù–∞–ø–∏—à–∏ <span class="output-info">help</span> –¥–ª—è —Å–ø–∏—Å–∫–∞ –∫–æ–º–∞–Ω–¥.</div>
                    <div class="output-line output-system">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</div>
                </div>
                <div class="input-line" style="padding: 0 20px 20px;">
                    <span class="prompt">‚ûú</span>&nbsp;
                    <span class="prompt-path">~/project</span>&nbsp;
                    <span class="prompt">(main)</span>&nbsp;
                    <input type="text" id="commandInput" autofocus autocomplete="off" spellcheck="false">
                </div>
            </div>

            <!-- Right Panel -->
            <div class="right-panel">
                <!-- Mission -->
                <div class="mission-card">
                    <div class="mission-header">
                        <span class="mission-level" id="missionLevel">–£—Ä–æ–≤–µ–Ω—å 1</span>
                        <span id="missionXP" style="color:#f6690a">+50 XP</span>
                    </div>
                    <div class="mission-title" id="missionTitle">–ü–µ—Ä–≤—ã–π –∫–æ–º–º–∏—Ç</div>
                    <div class="mission-desc" id="missionDesc">–°–æ–∑–¥–∞–π —Å–≤–æ–π –ø–µ—Ä–≤—ã–π –∫–æ–º–º–∏—Ç –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.</div>
                    <div class="mission-goal">
                        <div class="mission-goal-title">üéØ –¶–µ–ª—å:</div>
                        <div class="mission-goal-text" id="missionGoal">git commit -m "..."</div>
                    </div>
                    <button class="hint-btn" onclick="toggleHint()">üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
                    <div class="hint-text" id="hintText"></div>
                </div>

                <!-- Git Visualization -->
                <div class="git-viz">
                    <div class="git-viz-title">üìä –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</div>
                    <div id="gitViz" class="branch-container"></div>
                </div>

                <!-- Commands -->
                <div class="commands-ref">
                    <div class="commands-ref-title">üìñ –ö–æ–º–∞–Ω–¥—ã</div>
                    <div id="commandsList"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div class="modal" id="successModal">
        <div class="modal-content">
            <div class="modal-emoji">üéâ</div>
            <div class="modal-title">–ú–∏—Å—Å–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞!</div>
            <div class="modal-text" id="modalText">–û—Ç–ª–∏—á–Ω–æ! –¢—ã –æ—Å–≤–æ–∏–ª –Ω–æ–≤—É—é –∫–æ–º–∞–Ω–¥—É.</div>
            <div class="modal-xp" id="modalXP">+50 XP</div>
            <button class="modal-btn" onclick="nextMission()">–°–ª–µ–¥—É—é—â–∞—è –º–∏—Å—Å–∏—è ‚Üí</button>
        </div>
    </div>

    <!-- Level Select -->
    <div class="level-select" id="levelSelect">
        <button class="close-levels" onclick="closeLevelSelect()">‚úï</button>
        <div class="level-grid" id="levelGrid"></div>
    </div>

    <script>
        // Game Data
        const missions = [
            {
                id: 1,
                title: "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è",
                desc: "–ö–∞–∂–¥—ã–π Git –ø—Ä–æ–µ–∫—Ç –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –∫–æ–º–∞–Ω–¥—ã init. –û–Ω–∞ —Å–æ–∑–¥–∞—ë—Ç —Å–∫—Ä—ã—Ç—É—é –ø–∞–ø–∫—É .git –≥–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤—Å—è –∏—Å—Ç–æ—Ä–∏—è.",
                goal: "git init",
                hint: "–ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏: git init",
                xp: 30,
                command: "init",
                successMsg: "–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–∑–¥–∞–Ω! –¢–µ–ø–µ—Ä—å Git —Å–ª–µ–¥–∏—Ç –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏."
            },
            {
                id: 2,
                title: "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞",
                desc: "–ö–æ–º–∞–Ω–¥–∞ status –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: –∫–∞–∫–∏–µ —Ñ–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã, —á—Ç–æ –≥–æ—Ç–æ–≤–æ –∫ –∫–æ–º–º–∏—Ç—É.",
                goal: "git status",
                hint: "–ù–∞–ø–∏—à–∏: git status",
                xp: 30,
                command: "status",
                successMsg: "Status –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è!"
            },
            {
                id: 3,
                title: "–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤",
                desc: "–ü—Ä–µ–∂–¥–µ —á–µ–º —Å–¥–µ–ª–∞—Ç—å –∫–æ–º–º–∏—Ç, –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª—ã –≤ staging area –∫–æ–º–∞–Ω–¥–æ–π add.",
                goal: "git add .",
                hint: "–¢–æ—á–∫–∞ –æ–∑–Ω–∞—á–∞–µ—Ç '–≤—Å–µ —Ñ–∞–π–ª—ã': git add .",
                xp: 40,
                command: "add",
                successMsg: "–§–∞–π–ª—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ staging area!"
            },
            {
                id: 4,
                title: "–ü–µ—Ä–≤—ã–π –∫–æ–º–º–∏—Ç",
                desc: "–ö–æ–º–º–∏—Ç ‚Äî —ç—Ç–æ —Å–Ω–∏–º–æ–∫ —Ç–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞. –§–ª–∞–≥ -m –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ.",
                goal: "git commit -m \"...\"",
                hint: "–ù–∞–ø–∏—à–∏: git commit -m \"initial commit\"",
                xp: 50,
                command: "commit",
                successMsg: "–ü–µ—Ä–≤—ã–π –∫–æ–º–º–∏—Ç —Å–æ–∑–¥–∞–Ω! –≠—Ç–æ —Ç–≤–æ—è —Ç–æ—á–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è."
            },
            {
                id: 5,
                title: "–ò—Å—Ç–æ—Ä–∏—è –∫–æ–º–º–∏—Ç–æ–≤",
                desc: "–ö–æ–º–∞–Ω–¥–∞ log –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –≤—Å–µ—Ö –∫–æ–º–º–∏—Ç–æ–≤ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.",
                goal: "git log",
                hint: "–ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏: git log",
                xp: 40,
                command: "log",
                successMsg: "–¢–µ–ø–µ—Ä—å —Ç—ã –≤–∏–¥–∏—à—å –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞!"
            },
            {
                id: 6,
                title: "–°–æ–∑–¥–∞–Ω–∏–µ –≤–µ—Ç–∫–∏",
                desc: "–í–µ—Ç–∫–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ —Ñ–∏—á–∞–º–∏ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ. –°–æ–∑–¥–∞–π –Ω–æ–≤—É—é –≤–µ—Ç–∫—É!",
                goal: "git branch feature",
                hint: "–ù–∞–ø–∏—à–∏: git branch feature",
                xp: 50,
                command: "branch",
                successMsg: "–ù–æ–≤–∞—è –≤–µ—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∞! –≠—Ç–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –ª–∏–Ω–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏."
            },
            {
                id: 7,
                title: "–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–µ—Ç–æ–∫",
                desc: "–ö–æ–º–∞–Ω–¥–∞ checkout –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É –≤–µ—Ç–∫–∞–º–∏.",
                goal: "git checkout feature",
                hint: "–ù–∞–ø–∏—à–∏: git checkout feature",
                xp: 50,
                command: "checkout",
                successMsg: "–¢—ã –ø–µ—Ä–µ–∫–ª—é—á–∏–ª—Å—è –Ω–∞ –≤–µ—Ç–∫—É feature!"
            },
            {
                id: 8,
                title: "–°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ",
                desc: "Git switch ‚Äî –Ω–æ–≤—ã–π —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–µ—Ç–æ–∫ (Git 2.23+). –ü—Ä–æ—â–µ –∏ –ø–æ–Ω—è—Ç–Ω–µ–µ!",
                goal: "git switch main",
                hint: "–ù–∞–ø–∏—à–∏: git switch main",
                xp: 40,
                command: "switch",
                successMsg: "Switch ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ checkout –¥–ª—è –≤–µ—Ç–æ–∫!"
            },
            {
                id: 9,
                title: "–°–ª–∏—è–Ω–∏–µ –≤–µ—Ç–æ–∫",
                desc: "Merge –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ –¥—Ä—É–≥–æ–π –≤–µ—Ç–∫–∏ –≤ —Ç–µ–∫—É—â—É—é.",
                goal: "git merge feature",
                hint: "–ù–∞—Ö–æ–¥—è—Å—å –Ω–∞ main, –Ω–∞–ø–∏—à–∏: git merge feature",
                xp: 60,
                command: "merge",
                successMsg: "–í–µ—Ç–∫–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã! –ò–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ feature —Ç–µ–ø–µ—Ä—å –≤ main."
            },
            {
                id: 10,
                title: "–£–¥–∞–ª–µ–Ω–∏–µ –≤–µ—Ç–∫–∏",
                desc: "–ü–æ—Å–ª–µ —Å–ª–∏—è–Ω–∏—è –≤–µ—Ç–∫—É –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å —Ñ–ª–∞–≥–æ–º -d.",
                goal: "git branch -d feature",
                hint: "–ù–∞–ø–∏—à–∏: git branch -d feature",
                xp: 40,
                command: "branch -d",
                successMsg: "–í–µ—Ç–∫–∞ —É–¥–∞–ª–µ–Ω–∞! –î–µ—Ä–∂–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —á–∏—Å—Ç—ã–º."
            },
            {
                id: 11,
                title: "–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ",
                desc: "Clone —Å–æ–∑–¥–∞—ë—Ç –∫–æ–ø–∏—é —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –Ω–∞ —Ç–≤–æ—ë–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ.",
                goal: "git clone <url>",
                hint: "–ù–∞–ø–∏—à–∏: git clone https://github.com/user/repo",
                xp: 50,
                command: "clone",
                successMsg: "–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω! –¢–µ–ø–µ—Ä—å —É —Ç–µ–±—è –µ—Å—Ç—å –ª–æ–∫–∞–ª—å–Ω–∞—è –∫–æ–ø–∏—è."
            },
            {
                id: 12,
                title: "–î–æ–±–∞–≤–ª–µ–Ω–∏–µ remote",
                desc: "Remote ‚Äî —ç—Ç–æ —Å—Å—ã–ª–∫–∞ –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (GitHub, GitLab –∏ —Ç.–¥.)",
                goal: "git remote add origin <url>",
                hint: "–ù–∞–ø–∏—à–∏: git remote add origin https://github.com/user/repo",
                xp: 50,
                command: "remote",
                successMsg: "Remote –¥–æ–±–∞–≤–ª–µ–Ω! –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ push –∏ pull."
            },
            {
                id: 13,
                title: "–û—Ç–ø—Ä–∞–≤–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π",
                desc: "Push –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–≤–æ–∏ –∫–æ–º–º–∏—Ç—ã –Ω–∞ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä.",
                goal: "git push origin main",
                hint: "–ù–∞–ø–∏—à–∏: git push origin main",
                xp: 60,
                command: "push",
                successMsg: "–ò–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä! –î—Ä—É–≥–∏–µ –º–æ–≥—É—Ç –∏—Ö –≤–∏–¥–µ—Ç—å."
            },
            {
                id: 14,
                title: "–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π",
                desc: "Pull —Å–∫–∞—á–∏–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–∞ –∏ —Å–ª–∏–≤–∞–µ—Ç –∏—Ö —Å —Ç–≤–æ–µ–π –≤–µ—Ç–∫–æ–π.",
                goal: "git pull origin main",
                hint: "–ù–∞–ø–∏—à–∏: git pull origin main",
                xp: 60,
                command: "pull",
                successMsg: "–ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª—É—á–µ–Ω—ã! –¢–≤–æ—è –ª–æ–∫–∞–ª—å–Ω–∞—è –∫–æ–ø–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞."
            },
            {
                id: 15,
                title: "–§–∏–Ω–∞–ª—å–Ω—ã–π –±–æ—Å—Å: Rebase",
                desc: "Rebase –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç –∫–æ–º–º–∏—Ç—ã –Ω–∞ –≤–µ—Ä—Ö—É—à–∫—É –¥—Ä—É–≥–æ–π –≤–µ—Ç–∫–∏. –°–æ–∑–¥–∞—ë—Ç —á–∏—Å—Ç—É—é –ª–∏–Ω–µ–π–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é.",
                goal: "git rebase main",
                hint: "–ù–∞—Ö–æ–¥—è—Å—å –Ω–∞ feature: git rebase main",
                xp: 100,
                command: "rebase",
                successMsg: "üèÜ –ú–ê–°–¢–ï–†! –¢—ã –æ—Å–≤–æ–∏–ª –¥–∞–∂–µ rebase ‚Äî –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—É—é —Ç–µ—Ö–Ω–∏–∫—É Git!"
            }
        ];

        const commands = [
            { name: "git init", desc: "–°–æ–∑–¥–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π" },
            { name: "git status", desc: "–ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å" },
            { name: "git add .", desc: "–î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã" },
            { name: "git commit -m", desc: "–°–¥–µ–ª–∞—Ç—å –∫–æ–º–º–∏—Ç" },
            { name: "git log", desc: "–ò—Å—Ç–æ—Ä–∏—è –∫–æ–º–º–∏—Ç–æ–≤" },
            { name: "git branch", desc: "–°–ø–∏—Å–æ–∫/—Å–æ–∑–¥–∞—Ç—å –≤–µ—Ç–∫—É" },
            { name: "git checkout", desc: "–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è" },
            { name: "git switch", desc: "–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –≤–µ—Ç–∫—É" },
            { name: "git merge", desc: "–°–ª–∏—Ç—å –≤–µ—Ç–∫–∏" },
            { name: "git clone", desc: "–ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ" },
            { name: "git push", desc: "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä" },
            { name: "git pull", desc: "–ü–æ–ª—É—á–∏—Ç—å —Å —Å–µ—Ä–≤–µ—Ä–∞" },
            { name: "git rebase", desc: "–ü–µ—Ä–µ–±–∞–∑–∏—Ä–æ–≤–∞—Ç—å" }
        ];

        const achievements = [
            { id: "first", emoji: "üéØ", name: "–ü–µ—Ä–≤—ã–π –∫–æ–º–º–∏—Ç" },
            { id: "branch", emoji: "üåø", name: "–í–µ—Ç–≤–ª–µ–Ω–∏–µ" },
            { id: "merge", emoji: "üîÄ", name: "–°–ª–∏—è–Ω–∏–µ" },
            { id: "remote", emoji: "‚òÅÔ∏è", name: "–û–±–ª–∞–∫–æ" },
            { id: "master", emoji: "üëë", name: "–ú–∞—Å—Ç–µ—Ä Git" }
        ];

        // Game State
        let gameState = {
            currentMission: 0,
            completedMissions: [],
            xp: 0,
            streak: 0,
            lastPlay: null,
            achievements: [],
            commits: ['C0'],
            branches: { main: 0, feature: null },
            currentBranch: 'main'
        };

        // Load game
        function loadGame() {
            const saved = localStorage.getItem('gitmaster-data');
            if (saved) {
                gameState = { ...gameState, ...JSON.parse(saved) };
            }
            updateUI();
            renderCommands();
            renderAchievements();
            updateStreak();
            loadMission(gameState.currentMission);
        }

        // Save game
        function saveGame() {
            localStorage.setItem('gitmaster-data', JSON.stringify(gameState));
        }

        // Update streak
        function updateStreak() {
            const today = new Date().toDateString();
            if (gameState.lastPlay) {
                const last = new Date(gameState.lastPlay);
                const diff = Math.floor((new Date() - last) / (1000 * 60 * 60 * 24));
                if (diff === 1) gameState.streak++;
                else if (diff > 1) gameState.streak = 1;
            } else {
                gameState.streak = 1;
            }
            gameState.lastPlay = today;
            saveGame();
        }

        // Update UI
        function updateUI() {
            document.getElementById('levelNum').textContent = Math.floor(gameState.xp / 100) + 1;
            document.getElementById('xpNum').textContent = gameState.xp;
            document.getElementById('streakNum').textContent = gameState.streak;
            document.getElementById('completedNum').textContent = 
                `${gameState.completedMissions.length}/${missions.length}`;
        }

        // Load mission
        function loadMission(index) {
            if (index >= missions.length) {
                showCompletion();
                return;
            }
            const mission = missions[index];
            document.getElementById('missionLevel').textContent = `–£—Ä–æ–≤–µ–Ω—å ${index + 1}`;
            document.getElementById('missionTitle').textContent = mission.title;
            document.getElementById('missionDesc').textContent = mission.desc;
            document.getElementById('missionGoal').textContent = mission.goal;
            document.getElementById('missionXP').textContent = `+${mission.xp} XP`;
            document.getElementById('hintText').textContent = mission.hint;
            document.getElementById('hintText').classList.remove('visible');
            updateVisualization();
        }

        // Toggle hint
        function toggleHint() {
            document.getElementById('hintText').classList.toggle('visible');
        }

        // Process command
        function processCommand(cmd) {
            const terminal = document.getElementById('terminalBody');
            const input = cmd.trim().toLowerCase();
            
            // Add command to terminal
            addOutput(`<span class="prompt">‚ûú</span> <span class="prompt-path">~/project</span> <span class="prompt">(${gameState.currentBranch})</span> ${escapeHtml(cmd)}`, '');

            // Special commands
            if (input === 'help') {
                showHelp();
                return;
            }
            
            if (input === 'clear') {
                terminal.innerHTML = '';
                return;
            }

            // Check mission
            const mission = missions[gameState.currentMission];
            const isCorrect = checkCommand(input, mission);

            if (isCorrect) {
                // Success output
                simulateGitOutput(mission);
                
                // Update game state
                if (!gameState.completedMissions.includes(mission.id)) {
                    gameState.completedMissions.push(mission.id);
                    gameState.xp += mission.xp;
                }
                
                // Check achievements
                checkAchievements(mission);
                
                // Update visualization
                updateVisualizationForCommand(mission.command);
                
                saveGame();
                updateUI();
                
                // Show success modal
                setTimeout(() => {
                    document.getElementById('modalText').textContent = mission.successMsg;
                    document.getElementById('modalXP').textContent = `+${mission.xp} XP`;
                    document.getElementById('successModal').classList.add('visible');
                }, 500);
            } else {
                addOutput('–ö–æ–º–∞–Ω–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –∏–ª–∏ –Ω–µ–≤–µ—Ä–Ω–∞—è. –ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑!', 'output-error');
                addOutput(`–ü–æ–¥—Å–∫–∞–∑–∫–∞: ${mission.hint}`, 'output-warning');
            }
        }

        // Check command
        function checkCommand(input, mission) {
            const cmd = mission.command;
            
            if (cmd === 'init' && input.includes('git init')) return true;
            if (cmd === 'status' && input.includes('git status')) return true;
            if (cmd === 'add' && input.includes('git add')) return true;
            if (cmd === 'commit' && input.includes('git commit') && input.includes('-m')) return true;
            if (cmd === 'log' && input.includes('git log')) return true;
            if (cmd === 'branch' && input.includes('git branch') && !input.includes('-d')) return true;
            if (cmd === 'checkout' && input.includes('git checkout')) return true;
            if (cmd === 'switch' && input.includes('git switch')) return true;
            if (cmd === 'merge' && input.includes('git merge')) return true;
            if (cmd === 'branch -d' && input.includes('git branch -d')) return true;
            if (cmd === 'clone' && input.includes('git clone')) return true;
            if (cmd === 'remote' && input.includes('git remote')) return true;
            if (cmd === 'push' && input.includes('git push')) return true;
            if (cmd === 'pull' && input.includes('git pull')) return true;
            if (cmd === 'rebase' && input.includes('git rebase')) return true;
            
            return false;
        }

        // Simulate git output
        function simulateGitOutput(mission) {
            const outputs = {
                'init': ['Initialized empty Git repository in ~/project/.git/', 'output-success'],
                'status': ['On branch main\nNothing to commit, working tree clean', 'output-info'],
                'add': ['Files staged for commit', 'output-success'],
                'commit': ['[main abc1234] Your commit message\n 1 file changed, 10 insertions(+)', 'output-commit'],
                'log': ['commit abc1234 (HEAD -> main)\nAuthor: You\nDate: Today\n\n    Initial commit', 'output-commit'],
                'branch': ['Branch "feature" created', 'output-success'],
                'checkout': ['Switched to branch "feature"', 'output-success'],
                'switch': ['Switched to branch "main"', 'output-success'],
                'merge': ['Merge made by "recursive" strategy.\n 1 file changed', 'output-success'],
                'branch -d': ['Deleted branch feature', 'output-success'],
                'clone': ['Cloning into "repo"...\nReceiving objects: 100%\ndone.', 'output-success'],
                'remote': ['Remote "origin" added', 'output-success'],
                'push': ['Enumerating objects: 3, done.\nWriting objects: 100%\nBranch main set up to track origin/main', 'output-success'],
                'pull': ['Already up to date.\nOr: Updating abc1234..def5678', 'output-success'],
                'rebase': ['Successfully rebased and updated refs/heads/feature', 'output-success']
            };
            
            const [text, className] = outputs[mission.command] || ['Command executed', 'output-success'];
            text.split('\n').forEach(line => addOutput(line, className));
        }

        // Add output
        function addOutput(text, className) {
            const terminal = document.getElementById('terminalBody');
            const line = document.createElement('div');
            line.className = `output-line ${className}`;
            line.innerHTML = text;
            terminal.appendChild(line);
            terminal.scrollTop = terminal.scrollHeight;
        }

        // Show help
        function showHelp() {
            addOutput('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê', 'output-system');
            addOutput('üìñ –°–ü–†–ê–í–ö–ê –ü–û –ö–û–ú–ê–ù–î–ê–ú GIT', 'output-info');
            addOutput('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê', 'output-system');
            commands.forEach(cmd => {
                addOutput(`${cmd.name} ‚Äî ${cmd.desc}`, 'output-system');
            });
            addOutput('‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ', 'output-system');
            addOutput('clear ‚Äî –æ—á–∏—Å—Ç–∏—Ç—å —Ç–µ—Ä–º–∏–Ω–∞–ª', 'output-system');
            addOutput('help ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å —ç—Ç—É —Å–ø—Ä–∞–≤–∫—É', 'output-system');
        }

        // Next mission
        function nextMission() {
            document.getElementById('successModal').classList.remove('visible');
            gameState.currentMission++;
            saveGame();
            loadMission(gameState.currentMission);
        }

        // Update visualization
        function updateVisualization() {
            const viz = document.getElementById('gitViz');
            let html = '';
            
            // Main branch
            html += '<div class="branch-row">';
            gameState.commits.forEach((c, i) => {
                const isActive = i === gameState.commits.length - 1 && gameState.currentBranch === 'main';
                html += `<div class="commit-node ${isActive ? 'active' : ''}">${c}</div>`;
            });
            html += '<span class="branch-label main">main</span>';
            html += '</div>';
            
            // Feature branch if exists
            if (gameState.branches.feature !== null) {
                html += '<div class="branch-row" style="margin-left: ' + (gameState.branches.feature * 50) + 'px">';
                html += `<div class="commit-node ${gameState.currentBranch === 'feature' ? 'active' : ''}">F1</div>`;
                html += '<span class="branch-label feature">feature</span>';
                html += '</div>';
            }
            
            viz.innerHTML = html;
        }

        // Update visualization for command
        function updateVisualizationForCommand(cmd) {
            if (cmd === 'commit') {
                gameState.commits.push('C' + gameState.commits.length);
            }
            if (cmd === 'branch') {
                gameState.branches.feature = gameState.commits.length - 1;
            }
            if (cmd === 'checkout' || (cmd === 'switch' && gameState.currentBranch === 'feature')) {
                gameState.currentBranch = gameState.currentBranch === 'main' ? 'feature' : 'main';
            }
            if (cmd === 'merge') {
                gameState.branches.feature = null;
                gameState.commits.push('M' + gameState.commits.length);
            }
            if (cmd === 'branch -d') {
                gameState.branches.feature = null;
            }
            updateVisualization();
        }

        // Check achievements
        function checkAchievements(mission) {
            if (mission.id === 4 && !gameState.achievements.includes('first')) {
                gameState.achievements.push('first');
            }
            if (mission.id === 6 && !gameState.achievements.includes('branch')) {
                gameState.achievements.push('branch');
            }
            if (mission.id === 9 && !gameState.achievements.includes('merge')) {
                gameState.achievements.push('merge');
            }
            if (mission.id === 13 && !gameState.achievements.includes('remote')) {
                gameState.achievements.push('remote');
            }
            if (mission.id === 15 && !gameState.achievements.includes('master')) {
                gameState.achievements.push('master');
            }
            renderAchievements();
        }

        // Render achievements
        function renderAchievements() {
            const container = document.getElementById('achievements');
            container.innerHTML = achievements.map(a => {
                const unlocked = gameState.achievements.includes(a.id);
                return `<div class="achievement ${unlocked ? 'unlocked' : ''}" title="${a.name}">${a.emoji}</div>`;
            }).join('');
        }

        // Render commands
        function renderCommands() {
            const container = document.getElementById('commandsList');
            container.innerHTML = commands.map(cmd => `
                <div class="cmd-item" onclick="insertCommand('${cmd.name}')">
                    <div class="cmd-name">${cmd.name}</div>
                    <div class="cmd-desc">${cmd.desc}</div>
                </div>
            `).join('');
        }

        // Insert command
        function insertCommand(cmd) {
            document.getElementById('commandInput').value = cmd + ' ';
            document.getElementById('commandInput').focus();
        }

        // Show level select
        function showLevelSelect() {
            const grid = document.getElementById('levelGrid');
            grid.innerHTML = missions.map((m, i) => {
                const completed = gameState.completedMissions.includes(m.id);
                const locked = i > gameState.currentMission && !completed;
                return `
                    <div class="level-card ${completed ? 'completed' : ''} ${locked ? 'locked' : ''}" 
                         onclick="${locked ? '' : `selectLevel(${i})`}">
                        <div class="level-num">${i + 1}</div>
                        <div class="level-name">${m.title}</div>
                        <div class="level-status">
                            ${completed ? '‚úÖ –ü—Ä–æ–π–¥–µ–Ω–æ' : locked ? 'üîí –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ' : '‚ñ∂ –ò–≥—Ä–∞—Ç—å'}
                        </div>
                    </div>
                `;
            }).join('');
            document.getElementById('levelSelect').classList.add('visible');
        }

        // Select level
        function selectLevel(index) {
            gameState.currentMission = index;
            saveGame();
            loadMission(index);
            closeLevelSelect();
        }

        // Close level select
        function closeLevelSelect() {
            document.getElementById('levelSelect').classList.remove('visible');
        }

        // Show completion
        function showCompletion() {
            document.getElementById('missionTitle').textContent = 'üèÜ –í–°–ï –ú–ò–°–°–ò–ò –ü–†–û–ô–î–ï–ù–´!';
            document.getElementById('missionDesc').textContent = '–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –¢—ã –æ—Å–≤–æ–∏–ª Git –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–µ–∞–ª—å–Ω—ã–º –ø—Ä–æ–µ–∫—Ç–∞–º!';
            document.getElementById('missionGoal').textContent = '–¢—ã ‚Äî GitMaster!';
        }

        // Escape HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Matrix background
        function initMatrix() {
            const canvas = document.getElementById('matrix-bg');
            const ctx = canvas.getContext('2d');
            
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            const chars = 'git commit push pull branch merge rebase 01';
            const fontSize = 14;
            const columns = canvas.width / fontSize;
            const drops = Array(Math.floor(columns)).fill(1);
            
            function draw() {
                ctx.fillStyle = 'rgba(13, 17, 23, 0.05)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = '#f6690a';
                ctx.font = fontSize + 'px monospace';
                
                for (let i = 0; i < drops.length; i++) {
                    const text = chars[Math.floor(Math.random() * chars.length)];
                    ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                    
                    if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
                        drops[i] = 0;
                    }
                    drops[i]++;
                }
            }
            
            setInterval(draw, 50);
        }

        // Input handling
        document.getElementById('commandInput').addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && this.value.trim()) {
                processCommand(this.value);
                this.value = '';
            }
        });

        // Init
        loadGame();
        initMatrix();

        // Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./sw.js');
        }
    </script>
</body>
</html>
